<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Wynyard Product Knowledge Dashboard</title>
    <!--General Bootsrap to Ease Work-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!--Facicon-->
    <link rel="icon" type="image/x-icon" href="../favicon.ico" />
    <!--Social Media Buttons CSS -->
    <link rel="stylesheet" type="text/css"
        href="https://cdn.jsdelivr.net/gh/vaakash/socializer@master/css/socializer.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.4.2/css/all.css">
    <!--Local Files -->
    <link rel="stylesheet" href="../css/register.css">
    <!-- For functions -->
    <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <!--Yoinked-->
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, shrink-to-fit=no">
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th,
        td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="Header">
            <div class="navbar-wrapper ">
                <div class="navbar-local navbar navbar-expand-lg light is-scrolled">
                    <div class="container position-relative" style="flex-wrap:nowrap">
                        <a class="navbar-brand" href="/">
                            <img src="../img/logo.png"
                                class="img-fluid dark" alt="Logo" width="auto">
                            <!--<img src="img/LightVersion.png" class="img-fluid light" alt="Logo" width="auto">-->
                        </a>
                        <div class="navbar-toggler">
                            <button aria-label="toggler-menu" onclick="openNav()" class="">
                                <i class="fa-solid fa-bars"></i>
                            </button>
                        </div>
                        <div class="navbar-menu light d-lg-block">
                            <div class="navbar-menu-bg"></div>
                            <div class="navbar-menu-content">
                                <div class="navbar-collapse">
                                    <ul class="navbar-nav ml-auto">
                                        <li class="nav-item false">
                                            <div>
                                                <a class="nav-link fs-5" href="https://hiera.co.id/">Main Site</a>
                                            </div>
                                        </li>
                                        <li class="nav-item false">
                                            <div>
                                                <a class="nav-link fs-5" id="logout">Logout</a>
                                            </div>
                                         </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="navbar-menu light d-lg-none" id="dropdownnavmenu" style="/*display: none;*/">
                            <div class="white-layer">
                                <div class="navbar-menu-content" id="whitesecond"
                                    style="transform-origin: 487px 481px; transform: translate(0px, 0px); height: 25%; width: 80%;">
                                    <div class="navbar-collapse">
                                        <ul class="navbar-nav">
                                            <li class="nav-item">
                                                <div><a class="nav-link fs-5" href="https://hiera.co.id/">Main Site</a></div>
                                            </li>
                                            <li class="nav-item">
                                                <div> <a class="nav-link fs-5" id="logout2">Logout</a> </div>
                                            </li>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex flex-column container mt-5">
            <div class="pt-5 flex-fill">
                <h1>Dashboard</h1>
                <span id ="id-placeholder" style="display:none"></span>
            </div>
            <div class="pt-2 flex-fill">
                <div id="user-info">Loading...</div> 
            </div>
            <div class="border border-primary-subtle">
                <div class="d-flex flex-row p-3">
                    <div id="qr-code-container" class=" px-auto flex-fill" style="width: 60%">
                        <div>
                            <span id="qr-error-log"></span>
                            <center><img id="qr-code-img" alt="QR Code" style="display:none;" /></center>
                            <button class="login-form-button ant-btn ant-btn-link" id="regenButton"><span>Regenerate QR Code</span></button>
                        </div>
                    </div>
                    <div class="d-flex flex-column flex-fill" style="width: 30%">
                        <div class="p-2 flex-fill fs-3">
                            <span id="name">Loading...</span>
                        </div>
                        <div class="p-2 flex-fill fs-3">
                            <span id="email">Loading...</span>
                        </div>
                        <div class="p-2 flex-fill fs-3">
                            <span id="phone">Loading...</span>
                        </div>
                        <div class="p-2 flex-fill fs-3">
                            <span id="category">Loading...</span>
                        </div>
                        <div class="p-2 flex-fill fs-3">
                            <span id="company">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--TODO: ADD UPDATE DATA SECTION-->
        <div class="d-flex flex-column container mt-5">
            <div class="pt-5 flex-fill">
                <h3>Update your data</h3>
            </div>
            <div class="border border-primary-subtle">
                <div class="d-flex flex-column p-3">
                    <div id="qr-code-container px-auto flex-fill" style="width: 100%">
                        <center><img id="qr-code-img" alt="QR Code" style="display:none;" /></center>
                    </div>
                    <div class="d-flex flex-column flex-fill" style="width: 100%">
                        <form class="formregis ant-form ant-form-horizontal" id="user-form">
                            <div class="ant-row" style="margin-left: -7.5px; margin-right: -7.5px;">
                                <div class="ant-col ant-col-lg-12"
                                    style="padding-left: 7.5px; padding-right: 7.5px;">
                                    <div class="ant-row ant-form-item">
                                        <div class="ant-col ant-form-item-control-wrapper">
                                            <div class="ant-form-item-control"><span
                                                    class="ant-form-item-children"><input
                                                        placeholder="Full Name" type="text" autocomplete="off"
                                                        data-__meta="[object Object]"
                                                        data-__field="[object Object]" id="register_fullName"
                                                        class="ant-input" required></span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="ant-col ant-col-lg-12"
                                style="padding-left: 7.5px; padding-right: 7.5px;">
                                <div class="ant-row ant-form-item">
                                    <div class="ant-col ant-form-item-control-wrapper">
                                        <div class="ant-form-item-control"><span
                                                class="ant-form-item-children"><input
                                                    placeholder="Phone Number" type="tel"
                                                    autocomplete="off" data-__meta="[object Object]"
                                                    data-__field="[object Object]" id="register_phone"
                                                    class="ant-input" required></span></div>
                                    </div>
                                </div>
                            </div>
                                <div class="ant-col ant-col-lg-12" style="padding-left: 7.5px; padding-right: 7.5px;">
                                    <div class="ant-row ant-form-item">
                                        <div class="ant-col ant-form-item-control-wrapper">
                                            <div class="ant-form-item-control">
                                                <span class="ant-form-item-children">
                                                    <select id="register_category" class="ant-input" required>
                                                        <option value="" disabled selected>Select a Company Category</option>
                                                        <option value="Kantor Agent">Kantor Agent</option>
                                                        <option value="Bank">Bank</option>
                                                        <option value="Others">Others</option>
                                                    </select>
                                                </span>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="ant-col ant-col-lg-12"
                                style="padding-left: 7.5px; padding-right: 7.5px;">
                                <div class="ant-row ant-form-item">
                                    <div class="ant-col ant-form-item-control-wrapper">
                                        <div class="ant-form-item-control"><span
                                                class="ant-form-item-children"><input placeholder="Company"
                                                    type="text" autocomplete="off"
                                                    data-__meta="[object Object]"
                                                    data-__field="[object Object]" id="register_company"
                                                    class="ant-input" required></span></div>
                                    </div>
                                </div>
                            </div> 

                               
                                <div class="ant-col ant-col-lg-24"
                                    style="padding-left: 7.5px; padding-right: 7.5px;"><button 
                                        class="login-form-button ant-btn ant-btn-link" id="submitButton"><span>Update</span></button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div id="buffer-text" class="pb-5">
            <span></span>
        </div>s
    </div>
    <div id="footer" class="et_builder_inner_content et_pb_gutters3">
        <div class="et_pb_section et_pb_section_0_tb_footer et_pb_with_background et_section_regular">
            <div class="et_pb_row et_pb_row_0_tb_footer">
                <div
                    class="et_pb_column et_pb_column_4_4 et_pb_column_0_tb_footer  et_pb_css_mix_blend_mode_passthrough et-last-child">
                    <div
                        class="et_pb_module et_pb_text et_pb_text_0_tb_footer  et_pb_text_align_center et_pb_bg_layout_light">
                        <div class="et_pb_text_inner">
                            <p>A joint venture company of</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="et_pb_row et_pb_row_1_tb_footer et_pb_gutters1">
                <div
                    class="et_pb_column et_pb_column_4_4 et_pb_column_1_tb_footer  et_pb_css_mix_blend_mode_passthrough et-last-child">
                    <div class="et_pb_module et_pb_image et_pb_image_0_tb_footer">
                        <span class="et_pb_image_wrap "><img decoding="async" loading="lazy" width="1080" height="165"
                                src="https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-mitbana-sinarmas-land-logo.png"
                                alt="" title=""
                                srcset="https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-mitbana-sinarmas-land-logo.png 1080w, https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-mitbana-sinarmas-land-logo-980x150.png 980w, https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-mitbana-sinarmas-land-logo-480x73.png 480w"
                                sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) 1080px, 100vw"
                                class="wp-image-907"></span>
                    </div>
                </div>
            </div>
            <div class="et_pb_row et_pb_row_2_tb_footer">
                <div
                    class="et_pb_column et_pb_column_4_4 et_pb_column_2_tb_footer  et_pb_css_mix_blend_mode_passthrough et-last-child">
                    <div
                        class="et_pb_module et_pb_text et_pb_text_1_tb_footer  et_pb_text_align_left et_pb_text_align_center-phone et_pb_bg_layout_light">
                        <div class="et_pb_text_inner">
                            <p>Connect with us through social media portals</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="et_pb_row et_pb_row_3_tb_footer hiera-footer et_pb_equal_columns">
                <div
                    class="et_pb_column et_pb_column_1_2 et_pb_column_3_tb_footer  et_pb_css_mix_blend_mode_passthrough d-flex flex-row">
                    <div class="et_pb_module et_pb_image et_pb_image_1_tb_footer">
                        <a href="https://bit.ly/3DXaXgz" target="_blank"><span class="et_pb_image_wra                            (async () => {
                                try {
                                    await update(ref(database, `guests/${id}`), {qrCodeURL: qrCodeDataURL});
                                }
                                catch (error) {
                                    console.error('Error updating user data:', error);
                                    alert(error)
                                }
                            })();           alt="" title="" class="wp-image-909"></span></a>
                    </div>
                    <div class="et_pb_module et_pb_image et_pb_image_2_tb_footer">
                        <a href="https://www.instagram.com/hierabsd/" target="_blank"><span
                                class="et_pb_image_wrap "><img decoding="async" loading="lazy" width="64" height="64"
                                    src="https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-icon-64px_0002_ig.png"
                                    alt="" title="" class="wp-image-910"></span></a>
                    </div>
                    <div class="et_pb_module et_pb_image et_pb_image_3_tb_footer">
                        <a href="https://www.tiktok.com/@hierabsd" target="_blank"><span class="et_pb_image_wrap "><img
                                    decoding="async" loading="lazy" width="64" height="64"
                                    src="https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-icon-64px_0000_tiktok.png"
                                    alt="" title="" class="wp-image-911"></span></a>
                    </div>
                    <div class="et_pb_module et_pb_image et_pb_image_4_tb_footer">
                        <a href="https://bit.ly/3UHncnj" target="_blank"><span class="et_pb_image_wrap "><img
                                    decoding="async" loading="lazy" width="64" height="64"
                                    src="https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-icon-64px_0001_youtube.png"
                                    alt="" title="" class="wp-image-912"></span></a>
                    </div>
                </div>
                <div
                    class="et_pb_column et_pb_column_1_2 et_pb_column_4_tb_footer  et_pb_css_mix_blend_mode_passthrough et-last-child">
                    <div class="et_pb_module et_pb_image et_pb_image_5_tb_footer">
                        <span class="et_pb_image_wrap "><img decoding="async" loading="lazy" width="1375" height="684"
                                src="https://hiera.co.id/wp-content/uploads/2022/11/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-logo-3.png"
                                alt="" title=""
                                srcset="https://hiera.co.id/wp-content/uploads/2022/11/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-logo-3.png 1375w, https://hiera.co.id/wp-content/uploads/2022/11/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-logo-3-1280x637.png 1280w, https://hiera.co.id/wp-content/uploads/2022/11/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-logo-3-980x488.png 980w, https://hiera.co.id/wp-content/uploads/2022/11/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-logo-3-480x239.png 480w"
                                sizes="(min-width: 0px) and (max-width: 480px) 480px, (min-width: 481px) and (max-width: 980px) 980px, (min-width: 981px) and (max-width: 1280px) 1280px, (min-width: 1281px) 1375px, 100vw"
                                class="wp-image-1084"></span>
                    </div>
                </div>
            </div>
            <div class="et_pb_row et_pb_row_4_tb_footer et_pb_gutters3 et_pb_row_4col">
                <div
                    class="et_pb_column et_pb_column_1_4 et_pb_column_5_tb_footer  et_pb_css_mix_blend_mode_passthrough">
                    <div
                        class="et_pb_module et_pb_text et_pb_text_2_tb_footer  et_pb_text_align_left et_pb_text_align_center-phone et_pb_bg_layout_light">
                        <div class="et_pb_text_inner">
                            <h4>Business Hours</h4>
                        </div>
                    </div>
                    <div
                        class="et_pb_module et_pb_text et_pb_text_3_tb_footer  et_pb_text_align_left et_pb_bg_layout_light">
                        <div class="et_pb_text_inner">
                            <p>Monday to Sunday:<br>8:30 AM-5:30 PM</p>
                        </div>
                    </div>
                </div>
                <div
                    class="et_pb_column et_pb_column_1_4 et_pb_column_6_tb_footer  et_pb_css_mix_blend_mode_passthrough">
                    <div
                        class="et_pb_module et_pb_text et_pb_text_4_tb_footer  et_pb_text_align_left et_pb_text_align_center-phone et_pb_bg_layout_light">
                        <div class="et_pb_text_inner">
                            <h4>Marketing Gallery</h4>
                        </div>
                    </div>
                    <div
                        class="et_pb_module et_pb_text et_pb_text_5_tb_footer  et_pb_text_align_left et_pb_bg_layout_light">
                        <div class="et_pb_text_inner">
                            <p>The Breeze – Lake Level L. 03 Jl. BSD Grand Boulevard blok L no. L03 Green Office Park –
                                BSD City Sampora – Kab. Tangerang Banten 15345</p>
                        </div>
                    </div>
                </div>
                <div
                    class="et_pb_column et_pb_column_1_4 et_pb_column_7_tb_footer  et_pb_css_mix_blend_mode_passthrough">
                    <div
                        class="et_pb_module et_pb_text et_pb_text_6_tb_footer  et_pb_text_align_left et_pb_text_align_center-phone et_pb_bg_layout_light">
                        <div class="et_pb_text_inner">
                            <h4>Our Social Media</h4>
                        </div>
                    </div>
                    <div
                        class="et_pb_module et_pb_blurb et_pb_blurb_0_tb_footer et_clickable  et_pb_text_align_left  et_pb_blurb_position_left et_pb_bg_layout_light">
                        <div class="et_pb_blurb_content">
                            <div class="et_pb_main_blurb_image"><span
                                    class="et_pb_image_wrap et_pb_only_image_mode_wrap"><img decoding="async"
                                        loading="lazy" width="64" height="64"
                                        src="https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-icon-64px_0003_fb.png"
                                        alt=""
                                        class="et-waypoint et_pb_animation_top et_pb_animation_top_tablet et_pb_animation_top_phone wp-image-909 et-animated"
                                        title=""></span></div>
                            <div class="et_pb_blurb_container">
                                <h4 class="et_pb_module_header"><span>Facebook</span></h4>
                            </div>
                        </div>
                    </div>
                    <div
                        class="et_pb_module et_pb_blurb et_pb_blurb_1_tb_footer et_clickable  et_pb_text_align_left  et_pb_blurb_position_left et_pb_bg_layout_light">
                        <div class="et_pb_blurb_content">
                            <div class="et_pb_main_blurb_image"><span
                                    class="et_pb_image_wrap et_pb_only_image_mode_wrap"><img decoding="async"
                                        loading="lazy" width="64" height="64"
                                        src="https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-icon-64px_0002_ig.png"
                                        alt=""
                                        class="et-waypoint et_pb_animation_top et_pb_animation_top_tablet et_pb_animation_top_phone wp-image-910 et-animated"
                                        title=""></span></div>
                            <div class="et_pb_blurb_container">
                                <h4 class="et_pb_module_header"><span>Instagram</span></h4>
                            </div>
                        </div>
                    </div>
                    <div
                        class="et_pb_module et_pb_blurb et_pb_blurb_2_tb_footer et_clickable  et_pb_text_align_left  et_pb_blurb_position_left et_pb_bg_layout_light">
                        <div class="et_pb_blurb_content">
                            <div class="et_pb_main_blurb_image"><span
                                    class="et_pb_image_wrap et_pb_only_image_mode_wrap"><img decoding="async"
                                        loading="lazy" width="64" height="64"
                                        src="https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-icon-64px_0000_tiktok.png"
                                        alt=""
                                        class="et-waypoint et_pb_animation_top et_pb_animation_top_tablet et_pb_animation_top_phone wp-image-911 et-animated"
                                        title=""></span></div>
                            <div class="et_pb_blurb_container">
                                <h4 class="et_pb_module_header"><span>TikTok</span></h4>

                            </div>
                        </div>
                    </div>
                    <div
                        class="et_pb_module et_pb_blurb et_pb_blurb_3_tb_footer et_clickable  et_pb_text_align_left  et_pb_blurb_position_left et_pb_bg_layout_light">
                        <div class="et_pb_blurb_content">
                            <div class="et_pb_main_blurb_image"><span
                                    class="et_pb_image_wrap et_pb_only_image_mode_wrap"><img decoding="async"
                                        loading="lazy" width="64" height="64"
                                        src="https://hiera.co.id/wp-content/uploads/2022/10/hiera-bsd-perumahan-rumah-city-bumi-serpong-damai-jual-harga-tangerang-selatan-sinarmas-land-pt-sinar-mitbana-mas-the-heartland-of-hiera-icon-64px_0001_youtube.png"
                                        alt=""
                                        class="et-waypoint et_pb_animation_top et_pb_animation_top_tablet et_pb_animation_top_phone wp-image-912 et-animated"
                                        title=""></span></div>
                            <div class="et_pb_blurb_container">
                                <h4 class="et_pb_module_header"><span>Youtube</span></h4>

                            </div>
                        </div>
                    </div>
                </div>
                <div
                    class="et_pb_column et_pb_column_1_4 et_pb_column_8_tb_footer  et_pb_css_mix_blend_mode_passthrough et-last-child">
                    <div
                        class="et_pb_module et_pb_text et_pb_text_7_tb_footer  et_pb_text_align_left et_pb_text_align_center-phone et_pb_bg_layout_light">
                        <div class="et_pb_text_inner">
                            <h4>Menu</h4>
                        </div>
                    </div>
                    <div
                        class="et_pb_module et_pb_text et_pb_text_8_tb_footer  et_pb_text_align_left et_pb_bg_layout_light">
                        <div class="et_pb_text_inner"><span style="color: #666666;"><a href="/news/"
                                    style="color: #666666;">News &amp; Event</a></span><br>
                            <span style="color: #666666;"><a href="/3d-virtual/" style="color: #666666;">3D
                                    Virtual</a></span><br>
                            <span style="color: #666666;"><a href="/contact-us/" style="color: #666666;">Contact
                                    Us</a></span><br>
                            <a href="/disclaimer/"><span style="color: #666666;">Disclaimer</span></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="et_pb_row et_pb_row_5_tb_footer">
                <div
                    class="et_pb_column et_pb_column_4_4 et_pb_column_9_tb_footer  et_pb_css_mix_blend_mode_passthrough et-last-child">
                    <div
                        class="et_pb_module et_pb_text et_pb_text_10_tb_footer  et_pb_text_align_center et_pb_bg_layout_light">
                        <div class="et_pb_text_inner">
                            <div id="footer-info">© 2022-2024 <a href="/http://www.sinarmasland.com/">PT Sinar Mitbana Mas</a>. All rights reserved.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="module">
        import { auth } from '../js/firebase-config.js'; // Ensure this path is correct
        import { onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.8.0/firebase-auth.js';
        import { getDatabase, ref, get, set, update } from 'https://www.gstatic.com/firebasejs/9.8.0/firebase-database.js';
        import { goOffline } from 'https://www.gstatic.com/firebasejs/9.8.0/firebase-database.js';
        import { signout } from '../js/signout.js';
        const database = getDatabase();
        var userEmail;
        var userID;
        document.addEventListener('DOMContentLoaded', () => {
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    userEmail = user.email
                    await checkUserInDatabase(user.email);
                } else {
                    document.getElementById('user-info').innerHTML = 'User not signed in';
                }
            });
        });
        async function checkUserInDatabase(email) {
            const usersRef = ref(database, 'guests');
            try {
                const snapshot = await get(usersRef);
                let found = false;

                snapshot.forEach(childSnapshot => {
                    const userData = childSnapshot.val();
                    if (userData.email === email) {
                        found = true;
                        displayUserData(userData);
                    }
                });
                if (!found) {
                    document.getElementById('user-info').innerHTML = 'No data found for this user';
                    document.getElementById('email').innerHTML = `Email: ${email}`;
                    //Protocol to create new node for them. BECAUSE Goddammit the internet SUCKS.
                    const newId = Date.now();
                    userID = newId;

                    const data = { email: email, id: newId}
                    await set(ref(database, `guests/${newId}`), data);
                    console.log("New Child created")
                    document.getElementById('id-placeholder').innerHTML = `${newId}`;

                }
            } catch (error) {

                console.error('Error fetching user data:', error);
                alert(error)
            }
        }
        function displayUserData(userData) {
            const userInfoDiv = document.getElementById('user-info');
            if(userData.name) userInfoDiv.innerHTML = `<h2>Welcome, ${userData.name}</h2>`;
            if(userData.name) document.getElementById('name').innerHTML = `Name: ${userData.name}`;
            document.getElementById('email').innerHTML = `Email: ${userEmail}`;
            if(userData.phoneno) document.getElementById('phone').innerHTML = `Phone: ${userData.phoneno}`;
            if(userData.category) document.getElementById('category').innerHTML = `category: ${userData.category}`;
            if(userData.company) document.getElementById('company').innerHTML = `Company: ${userData.company}`;
            if(userData.id) document.getElementById('id-placeholder').innerHTML = `${userData.id}`;

            userID = userData.id;
            //console.log(userID)
            if (userData.qrCodeURL) {
                const qrCodeImg = document.getElementById('qr-code-img');
                qrCodeImg.src = userData.qrCodeURL;
                qrCodeImg.style.display = 'block'; 
            } 
            else {
                document.getElementById('qr-error-log').innerHTML = 'No QR code found for this user';
            }
            setTimeout(() => {
                //goOffline(database);
                //console.log('Disconnected from the database');
            }, 5000); // 5-second delay
                //console.log('Disconnected from the database');
        }
        document.getElementById('logout').addEventListener('click', async () => {
            signout()
        });
        document.getElementById('logout2').addEventListener('click', async () => {
            signout()
        });
        /*Update Data part*/
        document.getElementById('submitButton').addEventListener('click', async (event) => {
            event.preventDefault();
            const name = document.getElementById('register_fullName').value;
            const phone = document.getElementById('register_phone').value;
            const category = document.getElementById('register_category').value;
            const company = document.getElementById('register_company').value;
            const email = document.getElementById('email').value;
            const usersRef = ref(database, 'guests');
            if (userID) { // Assuming userID is mandatory to identify the user
                const userRef = ref(database, `guests/${userID}`);
                try {
                    const snapshot = await get(userRef);
                    if (snapshot.exists()) {
                        console.log("User Found");
                        const updates = {};
                        if (name) updates.name = name;
                        if (phone) updates.phone = phone;
                        if (category) updates.category = category;
                        if (company) updates.company = company;
        
                        try {
                            submitButton.disabled = true;
                            submitButton.innerText = 'Submitting...';
                            await update(userRef, updates);
                        } catch (error) {
                            console.error('Error updating user data:', error);
                            alert('Error updating user data: ' + error.message);
                        }

                        if (name) document.getElementById('name').innerHTML = `Name: ${name}`;
                        if (name) document.getElementById('user-info').innerHTML = `<h2>Welcome,: ${name}</h2>`;

                        if (phone) document.getElementById('phone').innerHTML = `Phone ${phone}`;
                        if (category) document.getElementById('category').innerHTML = `Category: ${category}`;
                        if (company) document.getElementById('company').innerHTML = `Company: ${company}`;
        
                        submitButton.disabled = false;
                        submitButton.innerText = 'Update';
                    } else {
                        alert('No data found for this user');
                    }
                } catch (error) {
                    console.error('Error fetching user data:', error);
                    alert('Error fetching user data: ' + error.message);
                }
            } else {
                alert('Please provide a user ID to identify the user');
            }
        }); 
        /* Regenerate Code */


    
    </script>
    <script type="module">
        import { firebaseConfig } from '../js/firebase-config.js'; // Ensure this path is correct
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.8.0/firebase-app.js';
        import { onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.8.0/firebase-auth.js';
        import { getDatabase, ref, get, update } from 'https://www.gstatic.com/firebasejs/9.8.0/firebase-database.js';
        import { getDownloadURL, ref as storageRef, uploadString, uploadBytes, getStorage } from 'https://www.gstatic.com/firebasejs/9.8.0/firebase-storage.js';
        const app = initializeApp(firebaseConfig);
        const database2 = getDatabase();
        const storage = getStorage(app);
        document.getElementById('regenButton').addEventListener('click', async () => {
            var userID2 = document.getElementById('id-placeholder').innerHTML;
            console.log(userID2)
            function generateQrCode(qrContent) {
                return new Promise((resolve, reject) => {
                    const qrCode = new QRCode("qr-code-img", {
                        text: qrContent,
                        width: 256,
                        height: 256,
                        colorDark: '#000000',
                        colorLight: '#ffffff',
                        correctLevel: QRCode.CorrectLevel.H,
                    });
                    setTimeout(() => {
                        const qrCodeImg = qrCode._oDrawing._elImage;
                        if (qrCodeImg) {
                            const canvas = document.createElement('canvas');
                            canvas.width = qrCodeImg.width;
                            canvas.height = qrCodeImg.height;
                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(qrCodeImg, 0, 0);
                            resolve(canvas.toDataURL('image/png'));
                        } else {
                            reject(new Error('Failed to generate QR code'));
                        }
                    }, 500); // Wait for QR code to be generated
                });
            }
        
            try {
                const qrCodeDataURL = await generateQrCode(userID2);
                const qrCodeBlob = await (await fetch(qrCodeDataURL)).blob();
                const qrCodeStorageRef = storageRef(storage, `qr_codes/${userID2}.png`);
                await uploadBytes(qrCodeStorageRef, qrCodeBlob);
                const qrCodeURL = await getDownloadURL(qrCodeStorageRef);
                //alert(`Firing to ${userID2}`);
                await update(ref(database2, `guests/${userID2}`), { qrCodeURL: qrCodeURL });
                const qrCodeImgElement = document.getElementById('qr-code-img');
                qrCodeImgElement.src = qrCodeDataURL;
                qrCodeImgElement.style.display = 'block';
                console.log('QR code URL updated successfully');
            } catch (error) {
                console.error('Error generating or uploading QR code:', error);
                alert('Error generating or uploading QR code: ' + error.message);
            }
        });
    </script>
    <script src="../js/index.js" type="text/javascript"></script>
</body>
</html>